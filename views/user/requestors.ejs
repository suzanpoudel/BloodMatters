<%- include('.././partials/navbar.ejs'); %> <%-
include('.././partials/sidemenu.ejs'); %>
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
  crossorigin="anonymous"
/>
<link
  rel="stylesheet"
  href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
  integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/"
  crossorigin="anonymous"
/>
<link rel="stylesheet" href="/public/card.css">
<!-- <script>
    $(document).ready(function(){
  $(".edit_btn").click(function(){
    $(".edit_modal").attr('id','test');
  });
});
</script> -->

<main>
  <div class="px-4 py-5 my-5">
    <div class="text-danger-custom">
      <h3 class="fw-bold">Donate Blood</h3>
      <hr />
    </div>
    <%- include('.././partials/messages.ejs'); %> <% if(posts.length == 0) { %>
    <p class="lead">No requestors</p>
    <% } else { %> <% posts.forEach(Post => { %>

      <div
        class="card col-6 mx-auto my-5 border-1 border-brand py-2"
      >
        <div class="card-body">
          <p class="card-text">
            <small class="text-muted"
              ><%= moment(Post.updatedAt).format('LLLL')%></small
            >
          </p>
          <h5 class="card-title">
            <%= Post.title%><span class="badge badge-primary bg-danger-custom m-1 p-1"
              >Type <%=Post.creator.bloodgroup%></span
            >
          </h5>
          <p class="card-text"><%= Post.body%></p>
        </div>
        <div class="card-footer">
          <p class="card-text my-3">
            <small class="text-muted"
              >Posted by:
              <b class="text-success">
                <a
                  href="/profile/<%=Post.creator._id%>"
                  style="text-decoration: none"
                  ><%=Post.creator.name%><span
                    class="badge badge-dark bg-dark m-1 p-1"
                    >Age <%=moment().diff(Post.creator.dob,'years')%></span
                  ><span class="badge badge-dark bg-dark m-1 p-1">
                    <%=Post.creator.address%></span
                  >
                </a></b
              ></small
            >
          </p>
          <button
            type="button"
            class="btn btn-warning"
            data-bs-toggle="modal"
            data-bs-target="#donateBloodModal<%=Post._id%>"
          >
            Donate <i class="fas fa-hand-holding-heart"></i>
          </button>
        </div>
      </div>
      <hr class="border-3" />
  
      <!-- Donate Blood Modal -->
             
      <div class="modal fade" id="donateBloodModal<%=Post._id%>" tabindex="-1" role="dialog" aria-labelledby="donateBloodModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="donateBloodModalLabel">Donate Blood</h5>
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
                <form action="/users/donateblood/<%=Post._id%>" method="POST">
                    <div class="col-10 m-auto">
                        <div class="card">
                          <p>This will send notification to <%=Post.creator.name%></p>
                          <div class="card-body align-self-center">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-warning">Confirm Donate</button>
                          </div>
                        </div>
                    </div>
                  </form>
            </div>
        </div>
        </div>
    </div>

    <% }) %> <% } %>
  </div>
</main>
